generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./data.db"
}

// é ˜åŸŸãƒã‚¹ã‚¿
model Domain {
  id          String   @id @default(cuid())
  slug        String   @unique  // "marketing", "recruiting", etc.
  name        String             // "Marketing / PR"
  nameJa      String             // "ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ï¼åºƒå ±"
  emoji       String             // "ğŸ“¢"
  description String?
  faqs        Faq[]
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

// è§£æ±ºã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒã‚¹ã‚¿
model Keyword {
  id          String       @id @default(cuid())
  slug        String       @unique  // "efficiency", "standardization", etc.
  name        String                // "åŠ¹ç‡åŒ–"
  category    String                // "åŠ¹ç‡åŒ–" "å¹³æº–åŒ–" "æ­£ç¢ºåŒ–" etc.
  description String?               // è©³ç´°èª¬æ˜
  faqs        FaqKeyword[]
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
}

// Q&Aæœ¬ä½“
model Faq {
  id          String       @id @default(cuid())
  domainId    String
  domain      Domain       @relation(fields: [domainId], references: [id])
  question    String       // æ‚©ã¿ï¼ˆå…±æ„Ÿãƒã‚¤ãƒ³ãƒˆï¼‰
  episode     String?      // è©³ç´°ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰
  answer      String       // AIã§ã“ã†è§£æ±ºã§ãã¾ã™
  keywords    FaqKeyword[]
  status      String       @default("draft") // "draft" | "published"
  order       Int          @default(0)       // è¡¨ç¤ºé †
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
}

// Q&A â†” ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ ä¸­é–“ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆå¤šå¯¾å¤šï¼‰
model FaqKeyword {
  faqId     String
  faq       Faq     @relation(fields: [faqId], references: [id], onDelete: Cascade)
  keywordId String
  keyword   Keyword @relation(fields: [keywordId], references: [id], onDelete: Cascade)

  @@id([faqId, keywordId])
}

// ãƒãƒ£ãƒƒãƒˆãƒ­ã‚°ï¼ˆåˆ†æç”¨ï¼‰
model ChatLog {
  id          String   @id @default(cuid())
  sessionId   String
  userMessage String
  aiResponse  String
  matchedFaqId String?
  createdAt   DateTime @default(now())
}
